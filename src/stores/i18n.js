import { defineStore } from 'pinia'

export const useI18nStore = defineStore('i18n', {
  state: () => ({
    locale: localStorage.getItem('app_locale') || 'zh-CN'
  }),

  getters: {
    t: (state) => {
      const translations = {
        'zh-CN': {
          siteName: 'AI极速页导航',
          siteDescription: '个人收藏的实用网站导航',
          searchPlaceholder: '搜索...',
          searchIn: '在 {engine} 中搜索...',
          search: '搜索',
          login: '登录',
          logout: '退出',
          admin: '管理后台',
          settings: '设置',
          home: '首页',
          loading: '加载中...',
          sourceCode: '源码库',
          copyright: '© 2026 jisuye.com',
          poweredBy: 'Powered by GitHub',
          categoryManagement: '分类管理',
          addCategory: '添加分类',
          name: '名称',
          icon: '图标',
          order: '排序',
          actions: '操作',
          edit: '编辑',
          delete: '删除',
          linkManagement: '链接管理',
          selectCategory: '选择分类',
          addLink: '添加链接',
          title: '标题',
          url: 'URL',
          description: '描述',
          searchEngines: '搜索引擎',
          defaultSearchEngine: '默认搜索引擎',
          addSearchEngine: '添加搜索引擎',
          urlTemplate: 'URL模板',
          urlPlaceholder: '使用 {q} 作为搜索关键词占位符',
          skinManagement: '皮肤管理',
          selectSkin: '选择皮肤',
          skinPreview: '皮肤预览',
          previewSkin: '预览',
          currentSkin: '当前',
          resetToDefault: '恢复默认',
          applySkin: '应用皮肤',
          categoryTitle: '常用网站',
          previewLink1: '示例网站 1',
          previewLink2: '示例网站 2',
          previewLink3: '示例网站 3',
          previewLink4: '示例网站 4',
          previewDesc: '这是一个示例描述文本',
          clickToPreview: '点击皮肤卡片可以预览效果，选择后会立即应用到整个网站。',
          urlAutoComplete: '会自动补全 https://（相对路径以 / 开头除外）',
          urlTemplateExample: '使用 {q} 作为搜索关键词占位符，例如：https://www.google.com/search?q={q}',
          siteNameLabel: '站点名称',
          siteDescriptionLabel: '站点描述',
          language: '语言',
          simpleChinese: '简体中文',
          english: 'English',
          showSearch: '显示搜索',
          showCategories: '显示分类',
          showIcons: '显示图标',
          skinLabel: '选择皮肤',
          save: '保存',
          cancel: '取消',
          confirm: '确认',
          categoryNamePlaceholder: '请输入分类名称',
          categoryIconPlaceholder: '请输入分类图标（如 el-icon-star）',
          categoryOrderPlaceholder: '请输入排序值',
          linkTitlePlaceholder: '请输入链接标题',
          linkUrlPlaceholder: '请输入链接URL',
          linkDescriptionPlaceholder: '请输入链接描述',
          engineNamePlaceholder: '请输入搜索引擎名称',
          engineUrlPlaceholder: '请输入搜索引擎URL模板',
          engineIconPlaceholder: '请输入搜索引擎图标',
          categoryNameRequired: '请输入分类名称',
          linkTitleRequired: '请输入链接标题',
          linkUrlRequired: '请输入链接URL',
          engineNameRequired: '请输入搜索引擎名称',
          engineUrlRequired: '请输入搜索引擎URL模板',
          deleteCategoryConfirm: '确认删除该分类吗？',
          deleteLinkConfirm: '确认删除该链接吗？',
          deleteEngineConfirm: '确认删除该搜索引擎吗？',
          operationSuccess: '操作成功',
          operationFailed: '操作失败',
          autoFetch: '自动获取',
          fetching: '获取中...',
          urlInfoFetched: '网站信息已获取',
          urlInfoPartial: '已从URL提取标题',
          urlInfoFailed: '获取网站信息失败，请手动填写',
          manageSearchEngines: '管理搜索引擎请前往',
          defaultSkins: '默认皮肤',
          customSkins: '自定义皮肤',
          createCustomSkin: '创建自定义皮肤',
          deleteCurrentSkin: '删除当前皮肤',
          skinName: '皮肤名称',
          skinNamePlaceholder: '请输入皮肤名称',
          baseSkin: '基于皮肤',
          primaryColor: '主色调',
          bgColor: '背景色',
          textColor: '文字颜色',
          create: '创建',
          pleaseInputSkinName: '请输入皮肤名称',
          createSuccess: '创建成功',
          createFailed: '创建失败',
          deleteSuccess: '删除成功',
          deleteFailed: '删除失败'
        },
        'en-US': {
          siteName: 'AI Speedy Nav',
          siteDescription: 'My collection of useful websites',
          searchPlaceholder: 'Search...',
          searchIn: 'Search in {engine}...',
          search: 'Search',
          login: 'Login',
          logout: 'Logout',
          admin: 'Admin',
          settings: 'Settings',
          home: 'Home',
          loading: 'Loading...',
          sourceCode: 'Source Code',
          copyright: '© 2026 jisuye.com',
          poweredBy: 'Powered by GitHub',
          categoryManagement: 'Category Management',
          addCategory: 'Add Category',
          name: 'Name',
          icon: 'Icon',
          order: 'Order',
          actions: 'Actions',
          edit: 'Edit',
          delete: 'Delete',
          linkManagement: 'Link Management',
          selectCategory: 'Select Category',
          addLink: 'Add Link',
          title: 'Title',
          url: 'URL',
          description: 'Description',
          searchEngines: 'Search Engines',
          defaultSearchEngine: 'Default Search Engine',
          addSearchEngine: 'Add Search Engine',
          urlTemplate: 'URL Template',
          urlPlaceholder: 'Use {q} as search keyword placeholder',
          skinManagement: 'Skin Management',
          selectSkin: 'Select Skin',
          skinPreview: 'Skin Preview',
          previewSkin: 'Preview',
          currentSkin: 'Current',
          resetToDefault: 'Reset to Default',
          applySkin: 'Apply Skin',
          categoryTitle: 'Common Websites',
          previewLink1: 'Example Site 1',
          previewLink2: 'Example Site 2',
          previewLink3: 'Example Site 3',
          previewLink4: 'Example Site 4',
          previewDesc: 'This is an example description',
          clickToPreview: 'Click on a skin card to preview. Selected skin will be immediately applied to the entire website.',
          urlAutoComplete: 'Will automatically prepend https:// (relative paths starting with / are excluded)',
          urlTemplateExample: 'Use {q} as search keyword placeholder, e.g., https://www.google.com/search?q={q}',
          siteNameLabel: 'Site Name',
          siteDescriptionLabel: 'Site Description',
          language: 'Language',
          simpleChinese: '简体中文',
          english: 'English',
          showSearch: 'Show Search',
          showCategories: 'Show Categories',
          showIcons: 'Show Icons',
          skinLabel: 'Select Skin',
          save: 'Save',
          cancel: 'Cancel',
          confirm: 'Confirm',
          categoryNamePlaceholder: 'Please enter category name',
          categoryIconPlaceholder: 'Please enter category icon (e.g., el-icon-star)',
          categoryOrderPlaceholder: 'Please enter order value',
          linkTitlePlaceholder: 'Please enter link title',
          linkUrlPlaceholder: 'Please enter link URL',
          linkDescriptionPlaceholder: 'Please enter link description',
          engineNamePlaceholder: 'Please enter search engine name',
          engineUrlPlaceholder: 'Please enter search engine URL template',
          engineIconPlaceholder: 'Please enter search engine icon',
          categoryNameRequired: 'Please enter category name',
          linkTitleRequired: 'Please enter link title',
          linkUrlRequired: 'Please enter link URL',
          engineNameRequired: 'Please enter search engine name',
          engineUrlRequired: 'Please enter search engine URL template',
          deleteCategoryConfirm: 'Are you sure you want to delete this category?',
          deleteLinkConfirm: 'Are you sure you want to delete this link?',
          deleteEngineConfirm: 'Are you sure you want to delete this search engine?',
          operationSuccess: 'Operation successful',
          operationFailed: 'Operation failed',
          autoFetch: 'Auto Fetch',
          fetching: 'Fetching...',
          urlInfoFetched: 'Website info fetched',
          urlInfoPartial: 'Title extracted from URL',
          urlInfoFailed: 'Failed to fetch website info, please fill manually',
          manageSearchEngines: 'Manage search engines at',
          defaultSkins: 'Default Skins',
          customSkins: 'Custom Skins',
          createCustomSkin: 'Create Custom Skin',
          deleteCurrentSkin: 'Delete Current Skin',
          skinName: 'Skin Name',
          skinNamePlaceholder: 'Please enter skin name',
          baseSkin: 'Base Skin',
          primaryColor: 'Primary Color',
          bgColor: 'Background Color',
          textColor: 'Text Color',
          create: 'Create',
          pleaseInputSkinName: 'Please enter skin name',
          createSuccess: 'Created successfully',
          createFailed: 'Failed to create',
          deleteSuccess: 'Deleted successfully',
          deleteFailed: 'Failed to delete'
        }
      }
      return (key, params = {}) => {
        let text = translations[state.locale][key] || key
        // 支持简单的参数替换，如 {engine}
        Object.keys(params).forEach(key => {
          text = text.replace(`{${key}}`, params[key])
        })
        return text
      }
    }
  },

  actions: {
    setLocale(locale) {
      this.locale = locale
      localStorage.setItem('app_locale', locale)
    },

    toggleLocale() {
      this.setLocale(this.locale === 'zh-CN' ? 'en-US' : 'zh-CN')
    }
  }
})
